#!/bin/bash

echo "Running pre-commit hooks..."

# Run Spotless check
echo "Checking code formatting with Spotless..."
./gradlew spotlessCheck --quiet

if [ $? -ne 0 ]; then
    echo ""
    echo "❌ Code formatting issues found!"
    echo "Run './gradlew spotlessApply' to fix formatting issues."
    echo ""
    exit 1
fi

echo "✅ Code formatting check passed!"

# Run tests
echo "Running tests..."
./gradlew test --quiet

if [ $? -ne 0 ]; then
    echo ""
    echo "❌ Tests failed!"
    echo "Please fix the failing tests before committing."
    echo ""
    exit 1
fi

echo "✅ All tests passed!"
echo ""
echo "✅ Pre-commit checks completed successfully!"
